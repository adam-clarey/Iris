From 2b7496d95b40e2a976a725399d551a7b4948b152 Mon Sep 17 00:00:00 2001
From: facascante <chito.cascante@gmail.com>
Date: Fri, 20 May 2016 15:37:56 +0800
Subject: [PATCH 1/3] add show/hidden field configuration in the *.iris.field
 file

---
 modules/core/entity/fields/boolean.iris.field |  3 ++-
 modules/core/entity/fields/date.iris.field    |  3 ++-
 modules/core/entity/fields/number.iris.field  |  3 ++-
 modules/core/entity/fields/string.iris.field  |  3 ++-
 modules/core/imagefield/image.iris.field      |  3 ++-
 modules/core/imagefield/imagefield.js         |  4 ++--
 modules/core/imagefield/offimage.iris.field   |  2 +-
 modules/extra/entityUI/schemaUI.js            | 16 +++++++++++++---
 8 files changed, 26 insertions(+), 11 deletions(-)

diff --git a/modules/core/entity/fields/boolean.iris.field b/modules/core/entity/fields/boolean.iris.field
index 094c51c..10bccfd 100644
--- a/modules/core/entity/fields/boolean.iris.field
+++ b/modules/core/entity/fields/boolean.iris.field
@@ -1,4 +1,5 @@
 {
   "name": "Boolean",
-  "type": "Boolean"
+  "type": "Boolean",
+  "hidden": true
 }
diff --git a/modules/core/entity/fields/date.iris.field b/modules/core/entity/fields/date.iris.field
index d0a0abd..6323ecd 100644
--- a/modules/core/entity/fields/date.iris.field
+++ b/modules/core/entity/fields/date.iris.field
@@ -1,4 +1,5 @@
 {
   "name": "Date",
-  "type": "Date"
+  "type": "Date",
+  "hidden": true
 }
diff --git a/modules/core/entity/fields/number.iris.field b/modules/core/entity/fields/number.iris.field
index 6b12896..60f6334 100644
--- a/modules/core/entity/fields/number.iris.field
+++ b/modules/core/entity/fields/number.iris.field
@@ -1,4 +1,5 @@
 {
   "name": "Number",
-  "type": "Number"
+  "type": "Number",
+  "hidden": true
 }
diff --git a/modules/core/entity/fields/string.iris.field b/modules/core/entity/fields/string.iris.field
index 5aa8e7f..c399725 100644
--- a/modules/core/entity/fields/string.iris.field
+++ b/modules/core/entity/fields/string.iris.field
@@ -1,4 +1,5 @@
 {
   "name": "Textfield",
-  "type": "String"
+  "type": "String",
+  "hidden": true
 }
diff --git a/modules/core/imagefield/image.iris.field b/modules/core/imagefield/image.iris.field
index bf6b02a..c695623 100644
--- a/modules/core/imagefield/image.iris.field
+++ b/modules/core/imagefield/image.iris.field
@@ -4,5 +4,6 @@
     "path": "String",
     "title": "String",
     "alt": "String"
-  }
+  },
+  "hidden": true
 }
diff --git a/modules/core/imagefield/imagefield.js b/modules/core/imagefield/imagefield.js
index 0fe70b9..2316779 100644
--- a/modules/core/imagefield/imagefield.js
+++ b/modules/core/imagefield/imagefield.js
@@ -79,7 +79,7 @@ iris.modules.filefield.registerHook("hook_entity_field_fieldType_save__image", 0
 
 });
 
-iris.modules.imagefield.registerHook("hook_entity_field_fieldType_form__multiple_image", 0, function (thisHook, data) {
+iris.modules.imagefield.registerHook("hook_entity_field_fieldType_form__images", 0, function (thisHook, data) {
 
   var value = thisHook.context.value;
   
@@ -113,7 +113,7 @@ iris.modules.imagefield.registerHook("hook_entity_field_fieldType_form__multiple
   
 });
 
-iris.modules.filefield.registerHook("hook_entity_field_fieldType_save__multiple_image", 0, function (thisHook, data) {
+iris.modules.filefield.registerHook("hook_entity_field_fieldType_save__images", 0, function (thisHook, data) {
 
   var fs = require("fs");
 
diff --git a/modules/core/imagefield/offimage.iris.field b/modules/core/imagefield/offimage.iris.field
index 501ecd7..05d74fe 100644
--- a/modules/core/imagefield/offimage.iris.field
+++ b/modules/core/imagefield/offimage.iris.field
@@ -1,5 +1,5 @@
 {
-  "name": "Multiple Image",
+  "name": "Images",
   "type": [{
     "path": "String",
     "title": "String",
diff --git a/modules/extra/entityUI/schemaUI.js b/modules/extra/entityUI/schemaUI.js
index 547ea36..2ddaf25 100644
--- a/modules/extra/entityUI/schemaUI.js
+++ b/modules/extra/entityUI/schemaUI.js
@@ -678,8 +678,18 @@ iris.modules.entityUI.registerHook("hook_form_render__schemaFieldListing", 0, fu
     });
     tableHtml += '</tbody></table>';
 
-
-
+    var displayFieldTypes = function(){
+      var allowedFieldTypes = {};
+      for(var key in iris.fieldTypes){
+        if(!iris.fieldTypes[key].hidden){
+          allowedFieldTypes[key] = iris.fieldTypes[key];
+        }
+      }
+       
+      return Object.keys(allowedFieldTypes).concat(["Fieldset"]);
+    };
+    
+    
     var weightFields = {
       "type": "array",
       "title": ap.t("weights"),
@@ -713,7 +723,7 @@ iris.modules.entityUI.registerHook("hook_form_render__schemaFieldListing", 0, fu
       "fieldType": {
         "type": "text",
         "title": ap.t("Field type"),
-        "enum": Object.keys(iris.fieldTypes).concat(["Fieldset"])
+        "enum": displayFieldTypes()
       },
       "entityType": {
         "type": "hidden",

From 8c03506c0707a61d9f1d1bc89414d4ca5f046a5a Mon Sep 17 00:00:00 2001
From: facascante <chito.cascante@gmail.com>
Date: Fri, 20 May 2016 15:49:00 +0800
Subject: [PATCH 2/3] put back textfield

---
 modules/core/entity/fields/string.iris.field | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/modules/core/entity/fields/string.iris.field b/modules/core/entity/fields/string.iris.field
index c399725..5aa8e7f 100644
--- a/modules/core/entity/fields/string.iris.field
+++ b/modules/core/entity/fields/string.iris.field
@@ -1,5 +1,4 @@
 {
   "name": "Textfield",
-  "type": "String",
-  "hidden": true
+  "type": "String"
 }

From 55b74aa45ab041c842f096862a6176149d91bbde Mon Sep 17 00:00:00 2001
From: facascante <chito.cascante@gmail.com>
Date: Fri, 20 May 2016 16:14:50 +0800
Subject: [PATCH 3/3] adjust test to remove solo field testing

---
 modules/core/entity/fields/string.iris.field | 3 ++-
 test/ui/ManageSchemaSpec.js                  | 2 +-
 test/ui/NestedFormSpec.js                    | 6 +++---
 3 files changed, 6 insertions(+), 5 deletions(-)

diff --git a/modules/core/entity/fields/string.iris.field b/modules/core/entity/fields/string.iris.field
index 5aa8e7f..c399725 100644
--- a/modules/core/entity/fields/string.iris.field
+++ b/modules/core/entity/fields/string.iris.field
@@ -1,4 +1,5 @@
 {
   "name": "Textfield",
-  "type": "String"
+  "type": "String",
+  "hidden": true
 }
diff --git a/test/ui/ManageSchemaSpec.js b/test/ui/ManageSchemaSpec.js
index bedcf80..2f09dd6 100644
--- a/test/ui/ManageSchemaSpec.js
+++ b/test/ui/ManageSchemaSpec.js
@@ -70,7 +70,7 @@ casper.test.begin('Test Schema Management', 6, function (test) {
       data: {
         'input[name = "label"]': "Sample",
         'input[name = "machineName"]': "sample",
-        'select[name = "fieldType"]': "Boolean"
+        'select[name = "fieldType"]': "Multiple boolean"
       }
     };
     util.test.openTransaction(options, function (err, result) {
diff --git a/test/ui/NestedFormSpec.js b/test/ui/NestedFormSpec.js
index 8357799..c41ae18 100644
--- a/test/ui/NestedFormSpec.js
+++ b/test/ui/NestedFormSpec.js
@@ -70,7 +70,7 @@ casper.test.begin('Test Nested Form fieldset', 8, function (test) {
       data: {
         'input[name = "label"]': schema + " textfield one",
         'input[name = "machineName"]': schema + "_textfield_one",
-        'select[name = "fieldType"]': "Textfield"
+        'select[name = "fieldType"]': "Multi text field"
       }
     };
     util.test.openTransaction(options, function (err, result) {
@@ -126,7 +126,7 @@ casper.test.begin('Test Nested Form fieldset', 8, function (test) {
       data: {
         'input[name = "label"]': schema + " textfield two",
         'input[name = "machineName"]': schema + "_textfield_two",
-        'select[name = "fieldType"]': "Textfield"
+        'select[name = "fieldType"]': "Multi text field"
       }
     };
     util.test.openTransaction(options, function (err, result) {
@@ -182,7 +182,7 @@ casper.test.begin('Test Nested Form fieldset', 8, function (test) {
       data: {
         'input[name = "label"]': schema + " textfield three",
         'input[name = "machineName"]': schema + "_textfield_three",
-        'select[name = "fieldType"]': "Textfield"
+        'select[name = "fieldType"]': "Multi text field"
       }
     };
     util.test.openTransaction(options, function (err, result) {
